# MPU6050_ESP8266_MQTT

A project to send acceleration (vibration) values from a MPU6050 sensor as MQTT messages through a ESP8266 module.

The project consists of these parts:
1.  Circuit diagram showing MPU6050 connected to a ESP8266 based nodeMCU module.
2.  Arduino sketch for the ESP8266.
3.  Steps to install and configure a MQTT broker on a Windows computer.
4.  Steps to capture the values and store in a file in CSV format along with timestamp.
5.  Steps to visualize the data in a chart in real time using MQTT-Spy.

## Hardware
nodeMCU (ESP8266) module
MPU6050 sensor
Cell phone charger or powerbank
Windows laptop
WiFi router

## Connections
![alt tag](https://github.com/tangophi/MPU6050_ESP8266_MQTT/blob/master/MPU6050_ESP8266.PNG)

## Power
The circuit can be powered either by a cell phone charger (5V) or a power bank.

## Arduino Sketch
The Arduino sketch to upload to the nodeMCU module is available in the MPU6050_DMP6_ESP8266_MQTT folder.

### Pre-requisites
1. Arduino is needed to program the nodeMCU module.  Download and install Arduino from https://www.arduino.cc/
2. ESP8266 support must be configured in the Arduino environment.  For steps to configure ESP8266, follow this link: https://github.com/esp8266/Arduino
3. MPU6050 library must be installed in the Arduino.  To install the library, in Arduino, goto Sketch->Include library->Library Manager.  In Library manager, search for "MPU6050" and the install library made by Jeff Rowberg.

### Modify Sketch for your environment
In the MPU6050_DMP6_ESP8266_MQTT.ino file, find these lines:

const char DEVICE_NAME[] = "mpu6050_1";
const char mqtt_topic_csv[] = "/mpu6050_1/csv";
const char mqtt_topic_json[] = "/mpu6050_1/json";

const char* ssid = "XXXXX";
const char* password = "YYYYYYY";

// IP address of your MQTT server
const char* mqtt_server = "192.168.0.114";

Update the 'ssid' to the SSID and 'password' to the password of your WiFI router.
Update the 'mqtt_server' to the IP of the computer running the MQTT broker.  More details of MQTT broker in the next section.
In case there is more than one circuit in your environment, update the 'DEVICE_NAME', 'mqtt_topic_csv' and 'mqtt_topic_json' to be unique for each circuit.

Upload the sketch to the nodeMCU module.  Once the sketch is uploaded, the nodeMCU will start reading vibration data from the MPU6050 sensor and start sending MQTT messages.

## MQTT broker
A MQTT broker is needed to get the MQTT messages generated by the nodeMCU module.  The simplest MQTT broker is the mosquitto broker and can be downloaded from https://mosquitto.org/download/.  Follow steps in http://www.steves-internet-guide.com/install-mosquitto-broker/ to install and configure the MQTT broker on your Windows computer.



## Capture data and store in a file

## Visualize real time data in MQTT-Spy
